const express        = require('express');
const router         = express.Router();
const R              = require('ramda');
const Exploit        = require('../../lib/db').Exploit;
const Comment        = require('../../lib/db').Comment;
const ensureLoggedIn = require('connect-ensure-login').ensureLoggedIn.bind(null, '/api/v1/users/login');

router.delete('/:id', ensureLoggedIn(), (req, res) => {
    Comment.find({where: [{id: req.params.id}, {UserId: req.user.id}]}).then( comment => {
        comment.destroy();
        res.json({err: false, message: 'Comment deleted'});
    }).catch(err => {
        res.json({err: true, message: `Can't delete that message`});
    });
});

module.exports = router;
